<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SLD - SFT Scaling Law - SLDAgent + o4-mini</title>
    <link rel="icon" type="image/png" href="assets/sld_logo.png" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500&family=Sora:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
    <style>
      :root {
        --bg-primary: #ffffff;
        --bg-secondary: #f8f9fa;
        --accent-primary: #2563eb;
        --accent-secondary: #3b82f6;
        --accent-gradient: linear-gradient(135deg, #2563eb 0%, #3b82f6 50%, #60a5fa 100%);
        --text-primary: #1f2937;
        --text-secondary: #4b5563;
        --border-subtle: rgba(0, 0, 0, 0.1);
        --glass-bg: rgba(0, 0, 0, 0.02);
        --success: #10b981;
      }

      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      body {
        font-family:
          "Sora",
          -apple-system,
          BlinkMacSystemFont,
          sans-serif;
        background: var(--bg-primary);
        min-height: 100vh;
        color: var(--text-primary);
      }

      .bg-pattern {
        display: none;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 2rem;
        position: relative;
        z-index: 1;
      }

      .back-link {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        color: var(--accent-primary);
        text-decoration: none;
        font-size: 0.9rem;
        margin-bottom: 1.5rem;
        transition: color 0.2s;
      }

      .back-link:hover {
        color: var(--accent-secondary);
      }

      .header {
        background: var(--glass-bg);
        border: 1px solid var(--border-subtle);
        border-radius: 16px;
        padding: 2rem;
        margin-bottom: 2rem;
        backdrop-filter: blur(10px);
      }

      .header h1 {
        font-size: 1.75rem;
        font-weight: 700;
        margin-bottom: 0.5rem;
        background: var(--accent-gradient);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .meta-row {
        display: flex;
        flex-wrap: wrap;
        gap: 1.5rem;
        margin-top: 1rem;
      }

      .meta-item {
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .meta-label {
        color: var(--text-secondary);
        font-size: 0.85rem;
      }

      .meta-value {
        font-weight: 600;
        color: var(--text-primary);
      }

      .r2-badge {
        display: inline-block;
        padding: 0.3rem 0.6rem;
        border-radius: 6px;
        font-weight: 600;
        font-size: 0.85rem;
        font-family: "JetBrains Mono", monospace;
      }

      .section-title {
        font-size: 1.25rem;
        font-weight: 600;
        margin-bottom: 1rem;
        color: var(--text-primary);
      }

      .runs-container {
        display: flex;
        flex-direction: column;
        gap: 1rem;
      }

      .run-card {
        background: var(--glass-bg);
        border: 1px solid var(--border-subtle);
        border-radius: 12px;
        overflow: hidden;
        transition: border-color 0.2s;
      }

      .run-card:hover {
        border-color: rgba(99, 102, 241, 0.3);
      }

      .run-card.best-run {
        border-color: var(--success);
        box-shadow: 0 0 20px rgba(16, 185, 129, 0.1);
      }

      .run-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 1rem 1.25rem;
        background: rgba(255, 255, 255, 0.02);
        cursor: pointer;
        transition: background 0.2s;
      }

      .run-header:hover {
        background: rgba(255, 255, 255, 0.04);
      }

      .run-info {
        display: flex;
        align-items: center;
        gap: 1rem;
      }

      .run-badge {
        padding: 0.25rem 0.6rem;
        border-radius: 6px;
        font-size: 0.75rem;
        font-weight: 600;
        background: rgba(255, 255, 255, 0.1);
        color: var(--text-secondary);
      }

      .run-badge.best-badge {
        background: var(--success);
        color: white;
      }

      .run-label {
        font-weight: 500;
        color: var(--text-primary);
      }

      .expand-icon {
        color: var(--text-muted);
        font-size: 0.8rem;
        transition: transform 0.2s;
      }

      .run-header.expanded .expand-icon {
        transform: rotate(180deg);
      }

      .run-content {
        border-top: 1px solid var(--border-subtle);
      }

      .code-container {
        overflow: hidden;
      }

      .code-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0.75rem 1.25rem;
        background: rgba(0, 0, 0, 0.2);
        border-bottom: 1px solid var(--border-subtle);
        font-size: 0.8rem;
        color: var(--text-muted);
      }

      .copy-btn {
        padding: 0.35rem 0.75rem;
        background: rgba(99, 102, 241, 0.2);
        border: 1px solid rgba(99, 102, 241, 0.3);
        border-radius: 6px;
        color: var(--accent-primary);
        font-size: 0.75rem;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s;
        font-family: inherit;
      }

      .copy-btn:hover {
        background: rgba(99, 102, 241, 0.3);
      }

      .code-container pre {
        margin: 0;
        padding: 1.25rem;
        font-family: "JetBrains Mono", monospace;
        font-size: 0.8rem;
        line-height: 1.6;
        overflow-x: auto;
        background: transparent !important;
      }

      .footer {
        text-align: center;
        margin-top: 3rem;
        padding-top: 2rem;
        border-top: 1px solid var(--border-subtle);
        color: var(--text-secondary);
        font-size: 0.85rem;
      }

      .footer a {
        color: var(--accent-primary);
        text-decoration: none;
      }

      @media (max-width: 768px) {
        .container {
          padding: 1rem;
        }

        .header h1 {
          font-size: 1.25rem;
        }

        .meta-row {
          flex-direction: column;
          gap: 0.75rem;
        }

        .run-info {
          flex-wrap: wrap;
          gap: 0.5rem;
        }
      }
    </style>
  </head>
  <body>
    <div class="bg-pattern"></div>

    <div class="container">
      <a href="index.html" class="back-link"> ← Back to Leaderboard </a>

      <div class="header">
        <h1>SFT Scaling Law</h1>
        <div class="meta-row">
          <div class="meta-item">
            <span class="meta-label">Agent:</span>
            <span class="meta-value">SLDAgent</span>
          </div>
          <div class="meta-item">
            <span class="meta-label">Model:</span>
            <span class="meta-value">o4-mini</span>
          </div>
          <div class="meta-item">
            <span class="meta-label">Best R²:</span>
            <span class="r2-badge" style="background-color: #006400; color: white"> 0.999264 </span>
          </div>
          <div class="meta-item">
            <span class="meta-label">Mean R²:</span>
            <span class="meta-value">0.995574</span>
          </div>
          <div class="meta-item">
            <span class="meta-label">Min R²:</span>
            <span class="meta-value">0.981141</span>
          </div>
          <div class="meta-item">
            <span class="meta-label">Runs:</span>
            <span class="meta-value">5</span>
          </div>
        </div>
      </div>

      <h2 class="section-title">All Runs (sorted by R²)</h2>

      <div class="runs-container">
        <div class="run-card best-run">
          <div class="run-header" onclick="toggleRun(this)">
            <div class="run-info">
              <span class="run-badge best-badge">Best</span>
              <span class="run-label">Run 2</span>
              <span class="r2-badge" style="background-color: #006400; color: white"> R² = 0.999264 </span>
            </div>
            <span class="expand-icon">▼</span>
          </div>
          <div class="run-content" style="display: block">
            <div class="code-container">
              <div class="code-header">
                <span>Python</span>
                <button class="copy-btn" onclick="copyCode(event, 'code-0')">Copy</button>
              </div>
              <pre><code class="language-python" id="code-0">import numpy as np
from scipy.optimize import minimize

# EVOLVE-BLOCK-START
def scaling_law_func(data_points, params):
    &quot;&quot;&quot;
    4-parameter logistic-saturating law:
      L(D) = L_inf + R / (1 + (D / D0)^alpha)
    params = [logD0, logalpha, logR, L_inf]
    &quot;&quot;&quot;
    D = np.atleast_1d(np.squeeze(data_points)).astype(np.float64)
    p = np.ravel(params).astype(np.float64)
    D0    = np.exp(p[0])
    alpha = np.exp(p[1])
    R     = np.exp(p[2])
    L_inf = p[3]
    denom = 1.0 + np.power(D / D0, alpha)
    # avoid div-by-zero
    return L_inf + R / (denom + 1e-12)

def fit_scaling_law(data_points, loss_values):
    &quot;&quot;&quot;
    Fit L(D) = L_inf + R / (1 + (D / D0)^alpha)
    by minimizing combined MSE + log-MSE for robust fit.
    Returns params = [logD0, logalpha, logR, L_inf].
    &quot;&quot;&quot;
    # Prepare data
    D = np.atleast_1d(np.squeeze(data_points)).astype(np.float64)
    L = np.ravel(loss_values).astype(np.float64)
    D = np.maximum(D, 1e-8)
    eps = 1e-8

    Lmin, Lmax = L.min(), L.max()
    logL = np.log(L + eps)

    # Bounds for [logD0, logalpha, logR, L_inf]
    bounds = [
        (np.log(D.min() * 0.01), np.log(D.max() * 100.0)),   # logD0
        (-5.0, 5.0),                                          # logalpha
        (np.log(eps), np.log(max(Lmax - Lmin, eps) * 10.0)),  # logR
        (0.0, Lmin)                                           # L_inf
    ]

    # Multi-start seeds
    D0_seeds = [np.median(D), D.min() * 5.0, D.max() / 5.0]
    alpha_seeds = [0.3, 0.5, 1.0]
    R0 = max(Lmax - Lmin, 1e-2)
    Linf0 = Lmin

    best_p, best_obj = None, np.inf

    for D0_guess in D0_seeds:
        for alpha_guess in alpha_seeds:
            p0 = np.array([
                np.log(D0_guess),
                np.log(alpha_guess),
                np.log(R0),
                Linf0
            ], dtype=np.float64)

            def obj(p):
                pred = scaling_law_func(D, p)
                mse = np.mean((pred - L) ** 2)
                log_mse = np.mean((np.log(pred + eps) - logL) ** 2)
                return mse + log_mse

            res = minimize(
                obj,
                p0,
                method=&#x27;L-BFGS-B&#x27;,
                bounds=bounds,
                options={&#x27;ftol&#x27;: 1e-9, &#x27;maxiter&#x27;: 3000}
            )
            if res.success and res.fun &lt; best_obj:
                best_obj, best_p = res.fun, res.x

    # Fallback if no start succeeded
    if best_p is None:
        best_p = np.array([
            np.log(np.median(D)),
            np.log(0.5),
            np.log(R0),
            Linf0
        ], dtype=np.float64)

    return best_p
# EVOLVE-BLOCK-END</code></pre>
            </div>
          </div>
        </div>
        <div class="run-card">
          <div class="run-header" onclick="toggleRun(this)">
            <div class="run-info">
              <span class="run-badge">#2</span>
              <span class="run-label">Run 5</span>
              <span class="r2-badge" style="background-color: #006400; color: white"> R² = 0.999261 </span>
            </div>
            <span class="expand-icon">▼</span>
          </div>
          <div class="run-content" style="display: none">
            <div class="code-container">
              <div class="code-header">
                <span>Python</span>
                <button class="copy-btn" onclick="copyCode(event, 'code-1')">Copy</button>
              </div>
              <pre><code class="language-python" id="code-1">import numpy as np
from scipy.optimize import least_squares

def scaling_law_func(D, p):
    # L(D) = L_inf + A / (D^alpha + N0)
    D = np.ravel(D).astype(float)
    L_inf, A, alpha, N0 = np.maximum(p, [0.0, 1e-12, 1e-6, 1e-12])
    return L_inf + A / (D**alpha + N0)

def fit_scaling_law(data_points, loss_values):
    D = np.ravel(data_points).astype(float)
    y = np.ravel(loss_values).astype(float)
    y0, y1 = y.min(), y.max()

    # Initial guesses
    L0 = max(0.0, 0.9 * y0)
    a0 = 0.5
    n0 = max(1e-8, D.min())
    A0 = max(1e-8, (y1 - L0) * (D.min()**a0 + n0))
    p0 = np.array([L0, A0, a0, n0])

    # Bounds
    lb = [0.0, 1e-12, 1e-6, 1e-12]
    ub = [y0,  np.inf, 50.0, D.max() * 10.0]

    # Residuals: combine absolute + relative error
    def residuals(p):
        pred = scaling_law_func(D, p)
        e = pred - y
        return np.concatenate([e, e / (y + 1e-8)])

    res = least_squares(
        residuals,
        p0,
        bounds=(lb, ub),
        loss=&#x27;soft_l1&#x27;,
        f_scale=0.1,
        max_nfev=5000
    )

    p_opt = res.x if res.success else p0
    return np.maximum(p_opt, [0.0, 0.0, 0.0, 0.0])</code></pre>
            </div>
          </div>
        </div>
        <div class="run-card">
          <div class="run-header" onclick="toggleRun(this)">
            <div class="run-info">
              <span class="run-badge">#3</span>
              <span class="run-label">Run 3</span>
              <span class="r2-badge" style="background-color: #006400; color: white"> R² = 0.999118 </span>
            </div>
            <span class="expand-icon">▼</span>
          </div>
          <div class="run-content" style="display: none">
            <div class="code-container">
              <div class="code-header">
                <span>Python</span>
                <button class="copy-btn" onclick="copyCode(event, 'code-2')">Copy</button>
              </div>
              <pre><code class="language-python" id="code-2">import numpy as np
from scipy.optimize import minimize

def scaling_law_func(data_points, params):
    &quot;&quot;&quot;
    4-parameter logistic-style scaling law:
      L(D) = L_inf + A / (1 + (D/D0)^alpha)
    params = [logA, logD0, logAlpha, L_inf]
    &quot;&quot;&quot;
    D = np.atleast_1d(np.squeeze(data_points)).astype(float)
    p = np.ravel(params).astype(float)
    A      = np.exp(p[0])
    D0     = np.exp(p[1])
    alpha  = np.exp(p[2])
    L_inf  = p[3]
    return L_inf + A / (1.0 + (D / D0)**alpha)

def fit_scaling_law(data_points, loss_values):
    &quot;&quot;&quot;
    Fit the 4-parameter form L_inf + A/(1+(D/D0)^alpha)
    by minimizing squared log-errors via L-BFGS-B.
    Returns optimized [logA, logD0, logAlpha, L_inf].
    &quot;&quot;&quot;
    D = np.atleast_1d(np.squeeze(data_points)).astype(float)
    L = np.ravel(loss_values).astype(float)
    D = np.maximum(D, 1e-8)
    # Initial guesses
    L_min, L_max = L.min(), L.max()
    L_inf0 = max(0.9 * L_min, 1e-3)
    A0      = max(L_max - L_inf0, 1e-3)
    D0_0    = np.median(D)
    alpha0  = 0.5
    p0 = np.array([np.log(A0), np.log(D0_0), np.log(alpha0), L_inf0], dtype=float)
    # Objective: mean squared log-residual
    def obj(p):
        pred = scaling_law_func(D, p)
        return np.mean((np.log(pred + 1e-8) - np.log(L + 1e-8))**2)
    # Optimize with L-BFGS-B for stability
    res = minimize(obj, p0, method=&#x27;L-BFGS-B&#x27;)
    return res.x if res.success else p0</code></pre>
            </div>
          </div>
        </div>
        <div class="run-card">
          <div class="run-header" onclick="toggleRun(this)">
            <div class="run-info">
              <span class="run-badge">#4</span>
              <span class="run-label">Run 4</span>
              <span class="r2-badge" style="background-color: #006400; color: white"> R² = 0.999086 </span>
            </div>
            <span class="expand-icon">▼</span>
          </div>
          <div class="run-content" style="display: none">
            <div class="code-container">
              <div class="code-header">
                <span>Python</span>
                <button class="copy-btn" onclick="copyCode(event, 'code-3')">Copy</button>
              </div>
              <pre><code class="language-python" id="code-3">import numpy as np
from scipy.optimize import least_squares

# EVOLVE-BLOCK-START
def scaling_law_func(data_points, params):
    &quot;&quot;&quot;
    4-parameter logistic scaling on log-data size:
      Let d = log10(D + eps).
      L(D) = L_inf + (L0 - L_inf) / [1 + (d/d_mid)^alpha].
    params = [L_inf, L0, d_mid, alpha]
    &quot;&quot;&quot;
    D = np.ravel(data_points).astype(float)
    d = np.log10(D + 1e-8)
    L_inf, L0, d_mid, alpha = params
    return L_inf + (L0 - L_inf) / (1.0 + np.power(d / d_mid, alpha))

def fit_scaling_law(data_points, loss_values):
    &quot;&quot;&quot;
    Fit [L_inf, L0, d_mid, alpha] by robust least_squares
    using a Cauchy loss for stability against outliers.
    &quot;&quot;&quot;
    D = np.ravel(data_points).astype(float)
    y = np.ravel(loss_values).astype(float)
    d = np.log10(D + 1e-8)
    y_min, y_max = float(y.min()), float(y.max())

    # Initial guesses: asymptote ~min loss, start ~max loss,
    # midpoint ~median(log10 D), slope ~1
    p0 = [y_min, y_max, float(np.median(d)), 1.0]

    # Bounds to keep parameters in sensible ranges
    lb = [
        0.0,                    # L_inf &gt;= 0
        y_max * 0.9,            # L0 &gt;= ~90% of max loss
        max(d.min() * 0.1, 1e-6),  # d_mid &gt; 0
        0.01                    # alpha &gt; 0
    ]
    ub = [
        y_min * 1.2 + 1e-6,     # L_inf not far above min loss
        y_max * 1.5 + 1e-6,     # L0 not far above max loss
        d.max() * 2.0 + 1e-6,   # d_mid up to 2× max(log D)
        20.0                    # alpha upper bound
    ]

    def residuals(p):
        return scaling_law_func(D, p) - y

    try:
        res = least_squares(
            residuals, p0,
            bounds=(lb, ub),
            loss=&#x27;cauchy&#x27;, f_scale=0.1,
            xtol=1e-9, ftol=1e-9, max_nfev=1000
        )
        return res.x if res.success else np.array(p0, dtype=float)
    except Exception:
        return np.array(p0, dtype=float)
# EVOLVE-BLOCK-END</code></pre>
            </div>
          </div>
        </div>
        <div class="run-card">
          <div class="run-header" onclick="toggleRun(this)">
            <div class="run-info">
              <span class="run-badge">#5</span>
              <span class="run-label">Run 1</span>
              <span class="r2-badge" style="background-color: #006400; color: white"> R² = 0.981141 </span>
            </div>
            <span class="expand-icon">▼</span>
          </div>
          <div class="run-content" style="display: none">
            <div class="code-container">
              <div class="code-header">
                <span>Python</span>
                <button class="copy-btn" onclick="copyCode(event, 'code-4')">Copy</button>
              </div>
              <pre><code class="language-python" id="code-4"># EVOLVE-BLOCK-START
import numpy as np
from scipy.optimize import least_squares

def scaling_law_func(data_points, params):
    &quot;&quot;&quot;
    4-parameter sigmoid-like scaling law:
      L(D) = a + b / (1 + (D / c)**d)
    where b, c, d are kept positive via absolute+eps.
    params: array([a, b, c, d])
    &quot;&quot;&quot;
    # Flatten to 1D array of data sizes
    D = np.atleast_1d(np.squeeze(data_points)).astype(float)
    a, b, c, d = params
    # enforce positivity for b, c, d
    b = np.abs(b) + 1e-12
    c = np.abs(c) + 1e-12
    d = np.abs(d) + 1e-12
    return a + b / (1.0 + (D / c)**d)

def fit_scaling_law(data_points, loss_values):
    &quot;&quot;&quot;
    Fit L(D) = a + b / (1 + (D/c)**d) via non-linear least squares.
    Returns optimized [a, b, c, d].
    &quot;&quot;&quot;
    # Prepare 1D arrays
    D = np.atleast_1d(np.squeeze(data_points)).astype(float)
    y = np.atleast_1d(np.squeeze(loss_values)).astype(float)
    # Basic statistics for initialization
    y_min, y_max = y.min(), y.max()
    # Initial guess
    a0 = max(y_min * 0.9, 1e-3)
    b0 = max(y_max - a0, 1e-3)
    c0 = np.median(D)
    d0 = 1.0
    p0 = np.array([a0, b0, c0, d0])
    # Bounds: b, c, d strictly positive
    lower = np.array([-np.inf, 1e-8, 1e-8, 1e-8])
    upper = np.array([ np.inf,  np.inf,  np.inf,  np.inf])
    # Residual function
    def residuals(p):
        return scaling_law_func(D, p) - y
    # Solve with trust-region-reflective bounds
    res = least_squares(residuals, p0, bounds=(lower, upper),
                        ftol=1e-8, xtol=1e-8, gtol=1e-8)
    return res.x if res.success else p0
# EVOLVE-BLOCK-END</code></pre>
            </div>
          </div>
        </div>
      </div>

      <footer class="footer">
        <p>
          SLDBench | <a href="https://arxiv.org/abs/2507.21184" target="_blank">arXiv:2507.21184</a> |
          <a href="https://github.com/linhaowei1/SLD" target="_blank">GitHub</a>
        </p>
      </footer>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script>
      function toggleRun(header) {
        const content = header.nextElementSibling;
        const isExpanded = content.style.display === "block";
        content.style.display = isExpanded ? "none" : "block";
        header.classList.toggle("expanded", !isExpanded);
      }

      function copyCode(event, codeId) {
        event.stopPropagation();
        const code = document.getElementById(codeId).textContent;
        navigator.clipboard.writeText(code).then(() => {
          const btn = event.target;
          btn.textContent = "Copied!";
          setTimeout(() => (btn.textContent = "Copy"), 2000);
        });
      }

      Prism.highlightAll();
    </script>
  </body>
</html>
