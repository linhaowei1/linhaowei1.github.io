<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SLD - MoE Scaling Law - codex + o4-mini</title>
    <link rel="icon" type="image/png" href="assets/sld_logo.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500&family=Sora:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
    <style>
        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #f8f9fa;
            --accent-primary: #2563eb;
            --accent-secondary: #3b82f6;
            --accent-gradient: linear-gradient(135deg, #2563eb 0%, #3b82f6 50%, #60a5fa 100%);
            --text-primary: #1f2937;
            --text-secondary: #4b5563;
            --border-subtle: rgba(0, 0, 0, 0.1);
            --glass-bg: rgba(0, 0, 0, 0.02);
            --success: #10b981;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Sora', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            min-height: 100vh;
            color: var(--text-primary);
        }
        
        .bg-pattern {
            display: none;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
            position: relative;
            z-index: 1;
        }
        
        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--accent-primary);
            text-decoration: none;
            font-size: 0.9rem;
            margin-bottom: 1.5rem;
            transition: color 0.2s;
        }
        
        .back-link:hover {
            color: var(--accent-secondary);
        }
        
        .header {
            background: var(--glass-bg);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 2rem;
            backdrop-filter: blur(10px);
        }
        
        .header h1 {
            font-size: 1.75rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            background: var(--accent-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .meta-row {
            display: flex;
            flex-wrap: wrap;
            gap: 1.5rem;
            margin-top: 1rem;
        }
        
        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .meta-label {
            color: var(--text-secondary);
            font-size: 0.85rem;
        }
        
        .meta-value {
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .r2-badge {
            display: inline-block;
            padding: 0.3rem 0.6rem;
            border-radius: 6px;
            font-weight: 600;
            font-size: 0.85rem;
            font-family: 'JetBrains Mono', monospace;
        }
        
        .section-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--text-primary);
        }
        
        .runs-container {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        
        .run-card {
            background: var(--glass-bg);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            overflow: hidden;
            transition: border-color 0.2s;
        }
        
        .run-card:hover {
            border-color: rgba(99, 102, 241, 0.3);
        }
        
        .run-card.best-run {
            border-color: var(--success);
            box-shadow: 0 0 20px rgba(16, 185, 129, 0.1);
        }
        
        .run-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 1.25rem;
            background: rgba(255, 255, 255, 0.02);
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .run-header:hover {
            background: rgba(255, 255, 255, 0.04);
        }
        
        .run-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .run-badge {
            padding: 0.25rem 0.6rem;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 600;
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-secondary);
        }
        
        .run-badge.best-badge {
            background: var(--success);
            color: white;
        }
        
        .run-label {
            font-weight: 500;
            color: var(--text-primary);
        }
        
        .expand-icon {
            color: var(--text-muted);
            font-size: 0.8rem;
            transition: transform 0.2s;
        }
        
        .run-header.expanded .expand-icon {
            transform: rotate(180deg);
        }
        
        .run-content {
            border-top: 1px solid var(--border-subtle);
        }
        
        .code-container {
            overflow: hidden;
        }
        
        .code-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem 1.25rem;
            background: rgba(0, 0, 0, 0.2);
            border-bottom: 1px solid var(--border-subtle);
            font-size: 0.8rem;
            color: var(--text-muted);
        }
        
        .copy-btn {
            padding: 0.35rem 0.75rem;
            background: rgba(99, 102, 241, 0.2);
            border: 1px solid rgba(99, 102, 241, 0.3);
            border-radius: 6px;
            color: var(--accent-primary);
            font-size: 0.75rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            font-family: inherit;
        }
        
        .copy-btn:hover {
            background: rgba(99, 102, 241, 0.3);
        }
        
        .code-container pre {
            margin: 0;
            padding: 1.25rem;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8rem;
            line-height: 1.6;
            overflow-x: auto;
            background: transparent !important;
        }
        
        .footer {
            text-align: center;
            margin-top: 3rem;
            padding-top: 2rem;
            border-top: 1px solid var(--border-subtle);
            color: var(--text-secondary);
            font-size: 0.85rem;
        }
        
        .footer a {
            color: var(--accent-primary);
            text-decoration: none;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }
            
            .header h1 {
                font-size: 1.25rem;
            }
            
            .meta-row {
                flex-direction: column;
                gap: 0.75rem;
            }
            
            .run-info {
                flex-wrap: wrap;
                gap: 0.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="bg-pattern"></div>
    
    <div class="container">
        <a href="sld_index.html" class="back-link">
            ← Back to Leaderboard
        </a>
        
        <div class="header">
            <h1>MoE Scaling Law</h1>
            <div class="meta-row">
                <div class="meta-item">
                    <span class="meta-label">Agent:</span>
                    <span class="meta-value">codex</span>
                </div>
                <div class="meta-item">
                    <span class="meta-label">Model:</span>
                    <span class="meta-value">o4-mini</span>
                </div>
                <div class="meta-item">
                    <span class="meta-label">Best R²:</span>
                    <span class="r2-badge" style="background-color: #D2691E; color: white;">
                        0.467622
                    </span>
                </div>
                <div class="meta-item">
                    <span class="meta-label">Mean R²:</span>
                    <span class="meta-value">0.467622</span>
                </div>
                <div class="meta-item">
                    <span class="meta-label">Min R²:</span>
                    <span class="meta-value">0.467622</span>
                </div>
                <div class="meta-item">
                    <span class="meta-label">Runs:</span>
                    <span class="meta-value">5</span>
                </div>
            </div>
        </div>
        
        <h2 class="section-title">All Runs (sorted by R²)</h2>
        
        <div class="runs-container">
            
        <div class="run-card best-run">
            <div class="run-header" onclick="toggleRun(this)">
                <div class="run-info">
                    <span class="run-badge best-badge">Best</span>
                    <span class="run-label">Run 1</span>
                    <span class="r2-badge" style="background-color: #D2691E; color: white;">
                        R² = 0.467622
                    </span>
                </div>
                <span class="expand-icon">▼</span>
            </div>
            <div class="run-content" style="display: block;">
                <div class="code-container">
                    <div class="code-header">
                        <span>Python</span>
                        <button class="copy-btn" onclick="copyCode(event, 'code-0')">Copy</button>
                    </div>
                    <pre><code class="language-python" id="code-0">&quot;&quot;&quot;
Scaling law prediction function for MoE validation loss.
&quot;&quot;&quot;
import math

# Fitted coefficients per experimental group
_COEFFICIENTS = {
    &#x27;all_data&#x27;: {
        &#x27;A&#x27;: 10.069179203081301,
        &#x27;b&#x27;: -0.027401922527553482,
        &#x27;c&#x27;: -0.07051248607961777,
    },
}

def law(input_data: list[dict[str, float]], group: str) -&gt; list[dict[str, float]]:
    &quot;&quot;&quot;
    Predicts output variables based on input variables according to a discovered scaling law.

    Args:
        input_data: A list of dictionaries, where each dictionary is a single data
                    point containing input variable names as keys and their
                    corresponding values.
        group: The name of the experimental group for which to make predictions.
               The functional form of the law is the same for all groups,
               but the fitted coefficients can differ per group.

    Returns:
        A list of dictionaries, corresponding to the input_data list, with each
        dictionary containing the predicted output variable(s) (key &#x27;loss_validation&#x27;).
    &quot;&quot;&quot;
    if group not in _COEFFICIENTS:
        raise ValueError(f&quot;Unknown group &#x27;{group}&#x27;. Available groups: {list(_COEFFICIENTS)}&quot;)
    params = _COEFFICIENTS[group]
    A = params[&#x27;A&#x27;]
    b = params[&#x27;b&#x27;]
    c = params[&#x27;c&#x27;]
    predictions = []
    for datum in input_data:
        ne = float(datum[&#x27;num_experts&#x27;])
        dp = float(datum[&#x27;dense_parameter_count&#x27;])
        loss_pred = A * (ne ** b) * (dp ** c)
        predictions.append({&#x27;loss_validation&#x27;: loss_pred})
    return predictions</code></pre>
                </div>
            </div>
        </div>
        
        <div class="run-card ">
            <div class="run-header" onclick="toggleRun(this)">
                <div class="run-info">
                    <span class="run-badge ">#2</span>
                    <span class="run-label">Run 2</span>
                    <span class="r2-badge" style="background-color: #D2691E; color: white;">
                        R² = 0.467622
                    </span>
                </div>
                <span class="expand-icon">▼</span>
            </div>
            <div class="run-content" style="display: none;">
                <div class="code-container">
                    <div class="code-header">
                        <span>Python</span>
                        <button class="copy-btn" onclick="copyCode(event, 'code-1')">Copy</button>
                    </div>
                    <pre><code class="language-python" id="code-1">from typing import List, Dict

def law(input_data: List[Dict[str, float]], group: str) -&gt; List[Dict[str, float]]:
    &quot;&quot;&quot;
    Predicts output variables based on input variables according to a discovered scaling law.

    Args:
        input_data: A list of dictionaries, each containing &#x27;num_experts&#x27; and
                    &#x27;dense_parameter_count&#x27; values.
        group: The experimental group name for parameter lookup.

    Returns:
        A list of dictionaries with predicted &#x27;loss_validation&#x27; values.
    &quot;&quot;&quot;
    # Scaling law form:
    #   loss_validation = a * num_experts^alpha * dense_parameter_count^beta
    GROUP_PARAMS = {
        &#x27;all_data&#x27;: {
            &#x27;a&#x27;: 10.069179203081301,
            &#x27;alpha&#x27;: -0.027401922527553482,
            &#x27;beta&#x27;: -0.07051248607961777,
        },
        # Additional groups can be added here
    }
    if group not in GROUP_PARAMS:
        raise ValueError(f&quot;Unknown group: {group}&quot;)
    params = GROUP_PARAMS[group]
    a = params[&#x27;a&#x27;]
    alpha = params[&#x27;alpha&#x27;]
    beta = params[&#x27;beta&#x27;]

    results: List[Dict[str, float]] = []
    for d in input_data:
        E = d.get(&#x27;num_experts&#x27;, 0.0)
        P = d.get(&#x27;dense_parameter_count&#x27;, 0.0)
        # Compute predicted validation loss using the power-law
        loss_pred = a * (E ** alpha) * (P ** beta)
        results.append({&#x27;loss_validation&#x27;: loss_pred})
    return results</code></pre>
                </div>
            </div>
        </div>
        
        <div class="run-card ">
            <div class="run-header" onclick="toggleRun(this)">
                <div class="run-info">
                    <span class="run-badge ">#3</span>
                    <span class="run-label">Run 3</span>
                    <span class="r2-badge" style="background-color: #D2691E; color: white;">
                        R² = 0.467622
                    </span>
                </div>
                <span class="expand-icon">▼</span>
            </div>
            <div class="run-content" style="display: none;">
                <div class="code-container">
                    <div class="code-header">
                        <span>Python</span>
                        <button class="copy-btn" onclick="copyCode(event, 'code-2')">Copy</button>
                    </div>
                    <pre><code class="language-python" id="code-2">&quot;&quot;&quot;
Module implementing the discovered scaling law for Mixture-of-Experts (MoE) models.
&quot;&quot;&quot;
import math

# Coefficients for each experimental group
_COEFFS = {
    &quot;all_data&quot;: {
        # loss_validation = A * dense_parameter_count^alpha * num_experts^beta
        &quot;A&quot;: 10.069179203081301,
        &quot;alpha&quot;: -0.07051248607961783,
        &quot;beta&quot;: -0.027401922527553444,
    },
}

def law(input_data: list[dict[str, float]], group: str) -&gt; list[dict[str, float]]:
    &quot;&quot;&quot;
    Predicts validation loss based on a power-law scaling with dense and expert parameters.

    Args:
        input_data: List of dicts with keys &#x27;dense_parameter_count&#x27; and &#x27;num_experts&#x27;.
        group: Experimental group name. Must match one of the keys in _COEFFS.

    Returns:
        List of dicts with key &#x27;loss_validation&#x27; for each input point.
    &quot;&quot;&quot;
    if group not in _COEFFS:
        raise ValueError(f&quot;Unknown group: {group}&quot;)
    params = _COEFFS[group]
    A = params[&quot;A&quot;]
    alpha = params[&quot;alpha&quot;]
    beta = params[&quot;beta&quot;]
    outputs: list[dict[str, float]] = []
    for entry in input_data:
        dense = entry.get(&quot;dense_parameter_count&quot;)
        experts = entry.get(&quot;num_experts&quot;)
        # compute prediction via power law
        pred = A * (dense ** alpha) * (experts ** beta)
        outputs.append({&quot;loss_validation&quot;: pred})
    return outputs</code></pre>
                </div>
            </div>
        </div>
        
        <div class="run-card ">
            <div class="run-header" onclick="toggleRun(this)">
                <div class="run-info">
                    <span class="run-badge ">#4</span>
                    <span class="run-label">Run 4</span>
                    <span class="r2-badge" style="background-color: #D2691E; color: white;">
                        R² = 0.467622
                    </span>
                </div>
                <span class="expand-icon">▼</span>
            </div>
            <div class="run-content" style="display: none;">
                <div class="code-container">
                    <div class="code-header">
                        <span>Python</span>
                        <button class="copy-btn" onclick="copyCode(event, 'code-3')">Copy</button>
                    </div>
                    <pre><code class="language-python" id="code-3">import math
from typing import List, Dict

_COEFS: Dict[str, Dict[str, float]] = {
    # coefficients for each experimental group
    &#x27;all_data&#x27;: {
        # scale factor a, exponent p for num_experts, exponent q for dense parameters
        &#x27;a&#x27;: 10.069179203081296,
        &#x27;p&#x27;: -0.0274019225275534,
        &#x27;q&#x27;: -0.0705124860796179,
    },
}

def law(input_data: List[Dict[str, float]], group: str) -&gt; List[Dict[str, float]]:
    &quot;&quot;&quot;
    Predicts output variables based on input variables according to a discovered scaling law.

    Args:
        input_data: A list of dictionaries, where each dictionary is a single data
                    point containing input variable names as keys and their
                    corresponding values.
        group: The name of the experimental group for which to make predictions.
               The functional form of the law is the same for all groups,
               but the constant parameters/coefficients can differ per group.

    Returns:
        A list of dictionaries, corresponding to the input_data list, with each
        dictionary containing the predicted output variable(s) under key
        &#x27;loss_validation&#x27;.
    &quot;&quot;&quot;
    if group not in _COEFS:
        raise ValueError(f&quot;Unknown group &#x27;{group}&#x27;. Available groups: {list(_COEFS.keys())}&quot;)
    params = _COEFS[group]
    a = params[&#x27;a&#x27;]
    p = params[&#x27;p&#x27;]
    q = params[&#x27;q&#x27;]
    predictions: List[Dict[str, float]] = []
    for datum in input_data:
        E = datum.get(&#x27;num_experts&#x27;)
        D = datum.get(&#x27;dense_parameter_count&#x27;)
        # scaling law: loss = a * E^p * D^q
        loss_pred = a * (E ** p) * (D ** q)
        predictions.append({&#x27;loss_validation&#x27;: loss_pred})
    return predictions</code></pre>
                </div>
            </div>
        </div>
        
        <div class="run-card ">
            <div class="run-header" onclick="toggleRun(this)">
                <div class="run-info">
                    <span class="run-badge ">#5</span>
                    <span class="run-label">Run 5</span>
                    <span class="r2-badge" style="background-color: #D2691E; color: white;">
                        R² = 0.467622
                    </span>
                </div>
                <span class="expand-icon">▼</span>
            </div>
            <div class="run-content" style="display: none;">
                <div class="code-container">
                    <div class="code-header">
                        <span>Python</span>
                        <button class="copy-btn" onclick="copyCode(event, 'code-4')">Copy</button>
                    </div>
                    <pre><code class="language-python" id="code-4">from typing import List, Dict

def law(input_data: List[Dict[str, float]], group: str) -&gt; List[Dict[str, float]]:
    &quot;&quot;&quot;
    Predicts output variables based on input variables according to a discovered scaling law.

    Args:
        input_data: A list of dictionaries, where each dictionary is a single data
                    point containing input variable names as keys and their
                    corresponding values.
        group: The name of the experimental group for which to make predictions.
               The functional form of the law is the same for all groups,
               but the constant parameters/coefficients can differ per group.

    Returns:
        A list of dictionaries, corresponding to the input_data list, with each
        dictionary containing the predicted output variable(s) (&quot;loss_validation&quot;).
    &quot;&quot;&quot;
    # Coefficients for each group: A * E^a * D^b
    coeffs = {
        &#x27;all_data&#x27;: {
            &#x27;A&#x27;: 10.06917920308131,
            &#x27;a&#x27;: -0.02740192252755355,
            &#x27;b&#x27;: -0.07051248607961802,
        }
    }
    if group not in coeffs:
        raise ValueError(f&quot;Unknown group: {group}&quot;)
    params = coeffs[group]
    results: List[Dict[str, float]] = []
    for datum in input_data:
        E = datum[&#x27;num_experts&#x27;]
        D = datum[&#x27;dense_parameter_count&#x27;]
        # Scaling law: loss = A * E^a * D^b
        loss_pred = params[&#x27;A&#x27;] * (E ** params[&#x27;a&#x27;]) * (D ** params[&#x27;b&#x27;])
        results.append({&#x27;loss_validation&#x27;: loss_pred})
    return results</code></pre>
                </div>
            </div>
        </div>
        
        </div>
        
        <footer class="footer">
            <p>SLDBench | <a href="https://arxiv.org/abs/2507.21184" target="_blank">arXiv:2507.21184</a> | <a href="https://github.com/linhaowei1/SLD" target="_blank">GitHub</a></p>
        </footer>
    </div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script>
        function toggleRun(header) {
            const content = header.nextElementSibling;
            const isExpanded = content.style.display === 'block';
            content.style.display = isExpanded ? 'none' : 'block';
            header.classList.toggle('expanded', !isExpanded);
        }
        
        function copyCode(event, codeId) {
            event.stopPropagation();
            const code = document.getElementById(codeId).textContent;
            navigator.clipboard.writeText(code).then(() => {
                const btn = event.target;
                btn.textContent = 'Copied!';
                setTimeout(() => btn.textContent = 'Copy', 2000);
            });
        }
        
        Prism.highlightAll();
    </script>
</body>
</html>