<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SLD - LR & Batch Size Scaling Law - openhands + GPT-5</title>
    <link rel="icon" type="image/png" href="assets/sld_logo.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500&family=Sora:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
    <style>
        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #f8f9fa;
            --accent-primary: #2563eb;
            --accent-secondary: #3b82f6;
            --accent-gradient: linear-gradient(135deg, #2563eb 0%, #3b82f6 50%, #60a5fa 100%);
            --text-primary: #1f2937;
            --text-secondary: #4b5563;
            --border-subtle: rgba(0, 0, 0, 0.1);
            --glass-bg: rgba(0, 0, 0, 0.02);
            --success: #10b981;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Sora', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            min-height: 100vh;
            color: var(--text-primary);
        }
        
        .bg-pattern {
            display: none;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
            position: relative;
            z-index: 1;
        }
        
        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--accent-primary);
            text-decoration: none;
            font-size: 0.9rem;
            margin-bottom: 1.5rem;
            transition: color 0.2s;
        }
        
        .back-link:hover {
            color: var(--accent-secondary);
        }
        
        .header {
            background: var(--glass-bg);
            border: 1px solid var(--border-subtle);
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 2rem;
            backdrop-filter: blur(10px);
        }
        
        .header h1 {
            font-size: 1.75rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            background: var(--accent-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .meta-row {
            display: flex;
            flex-wrap: wrap;
            gap: 1.5rem;
            margin-top: 1rem;
        }
        
        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .meta-label {
            color: var(--text-secondary);
            font-size: 0.85rem;
        }
        
        .meta-value {
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .r2-badge {
            display: inline-block;
            padding: 0.3rem 0.6rem;
            border-radius: 6px;
            font-weight: 600;
            font-size: 0.85rem;
            font-family: 'JetBrains Mono', monospace;
        }
        
        .section-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--text-primary);
        }
        
        .runs-container {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        
        .run-card {
            background: var(--glass-bg);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            overflow: hidden;
            transition: border-color 0.2s;
        }
        
        .run-card:hover {
            border-color: rgba(99, 102, 241, 0.3);
        }
        
        .run-card.best-run {
            border-color: var(--success);
            box-shadow: 0 0 20px rgba(16, 185, 129, 0.1);
        }
        
        .run-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 1.25rem;
            background: rgba(255, 255, 255, 0.02);
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .run-header:hover {
            background: rgba(255, 255, 255, 0.04);
        }
        
        .run-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .run-badge {
            padding: 0.25rem 0.6rem;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 600;
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-secondary);
        }
        
        .run-badge.best-badge {
            background: var(--success);
            color: white;
        }
        
        .run-label {
            font-weight: 500;
            color: var(--text-primary);
        }
        
        .expand-icon {
            color: var(--text-muted);
            font-size: 0.8rem;
            transition: transform 0.2s;
        }
        
        .run-header.expanded .expand-icon {
            transform: rotate(180deg);
        }
        
        .run-content {
            border-top: 1px solid var(--border-subtle);
        }
        
        .code-container {
            overflow: hidden;
        }
        
        .code-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem 1.25rem;
            background: rgba(0, 0, 0, 0.2);
            border-bottom: 1px solid var(--border-subtle);
            font-size: 0.8rem;
            color: var(--text-muted);
        }
        
        .copy-btn {
            padding: 0.35rem 0.75rem;
            background: rgba(99, 102, 241, 0.2);
            border: 1px solid rgba(99, 102, 241, 0.3);
            border-radius: 6px;
            color: var(--accent-primary);
            font-size: 0.75rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            font-family: inherit;
        }
        
        .copy-btn:hover {
            background: rgba(99, 102, 241, 0.3);
        }
        
        .code-container pre {
            margin: 0;
            padding: 1.25rem;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8rem;
            line-height: 1.6;
            overflow-x: auto;
            background: transparent !important;
        }
        
        .footer {
            text-align: center;
            margin-top: 3rem;
            padding-top: 2rem;
            border-top: 1px solid var(--border-subtle);
            color: var(--text-secondary);
            font-size: 0.85rem;
        }
        
        .footer a {
            color: var(--accent-primary);
            text-decoration: none;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }
            
            .header h1 {
                font-size: 1.25rem;
            }
            
            .meta-row {
                flex-direction: column;
                gap: 0.75rem;
            }
            
            .run-info {
                flex-wrap: wrap;
                gap: 0.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="bg-pattern"></div>
    
    <div class="container">
        <a href="sld_index.html" class="back-link">
            ← Back to Leaderboard
        </a>
        
        <div class="header">
            <h1>LR & Batch Size Scaling Law</h1>
            <div class="meta-row">
                <div class="meta-item">
                    <span class="meta-label">Agent:</span>
                    <span class="meta-value">openhands</span>
                </div>
                <div class="meta-item">
                    <span class="meta-label">Model:</span>
                    <span class="meta-value">GPT-5</span>
                </div>
                <div class="meta-item">
                    <span class="meta-label">Best R²:</span>
                    <span class="r2-badge" style="background-color: #B22222; color: white;">
                        -0.773483
                    </span>
                </div>
                <div class="meta-item">
                    <span class="meta-label">Mean R²:</span>
                    <span class="meta-value">-0.848988</span>
                </div>
                <div class="meta-item">
                    <span class="meta-label">Min R²:</span>
                    <span class="meta-value">-1.000000</span>
                </div>
                <div class="meta-item">
                    <span class="meta-label">Runs:</span>
                    <span class="meta-value">3</span>
                </div>
            </div>
        </div>
        
        <h2 class="section-title">All Runs (sorted by R²)</h2>
        
        <div class="runs-container">
            
        <div class="run-card best-run">
            <div class="run-header" onclick="toggleRun(this)">
                <div class="run-info">
                    <span class="run-badge best-badge">Best</span>
                    <span class="run-label">Run 1</span>
                    <span class="r2-badge" style="background-color: #B22222; color: white;">
                        R² = -0.773483
                    </span>
                </div>
                <span class="expand-icon">▼</span>
            </div>
            <div class="run-content" style="display: block;">
                <div class="code-container">
                    <div class="code-header">
                        <span>Python</span>
                        <button class="copy-btn" onclick="copyCode(event, 'code-0')">Copy</button>
                    </div>
                    <pre><code class="language-python" id="code-0">import math
from typing import List, Dict

# Shared exponents across all groups (fitted on provided dataset)
EXPONENTS = {
    &quot;lr&quot;: 0.008636919053849154,
    &quot;bsz&quot;: -0.0005162836622543873,
    &quot;data_size&quot;: -0.04700957690670233,
    &quot;non_embedding_param_size&quot;: -0.05174150134631459,
}

# Per-group log-intercepts (only &#x27;all_data&#x27; observed). Unknown groups fall back to this baseline.
LOG_INTERCEPTS = {
    &quot;all_data&quot;: 3.080501739652768,
}

DEFAULT_GROUP = &quot;all_data&quot;


def _safe_log(x: float) -&gt; float:
    if x is None or x &lt;= 0:
        raise ValueError(&quot;All inputs must be positive real numbers.&quot;)
    return math.log(x)


def law(input_data: List[Dict[str, float]], group: str) -&gt; List[Dict[str, float]]:
    &quot;&quot;&quot;
    Predicts output variables based on input variables according to a discovered scaling law.

    Args:
        input_data: A list of dictionaries, where each dictionary is a single data
                    point containing input variable names as keys and their
                    corresponding values.
        group: The name of the experimental group for which to make predictions.
                The functional form of the law must be the same for all groups,
                but the constant parameters/coefficients can differ per group.

    Returns:
        A list of dictionaries, corresponding to the input_data list, with each
        dictionary containing the predicted output variable(s).
    &quot;&quot;&quot;
    g = group if group in LOG_INTERCEPTS else DEFAULT_GROUP
    a = EXPONENTS[&quot;lr&quot;]
    b = EXPONENTS[&quot;bsz&quot;]
    c = EXPONENTS[&quot;data_size&quot;]
    d = EXPONENTS[&quot;non_embedding_param_size&quot;]
    intercept = LOG_INTERCEPTS[g]

    out = []
    for row in input_data:
        lr = float(row[&quot;lr&quot;])  # type: ignore[index]
        bsz = float(row[&quot;bsz&quot;])  # type: ignore[index]
        data_size = float(row[&quot;data_size&quot;])  # type: ignore[index]
        non_embed = float(row[&quot;non_embedding_param_size&quot;])  # type: ignore[index]

        log_pred = (
            intercept
            + a * _safe_log(lr)
            + b * _safe_log(bsz)
            + c * _safe_log(data_size)
            + d * _safe_log(non_embed)
        )
        pred = math.exp(log_pred)
        out.append({&quot;lm_loss&quot;: pred})
    return out</code></pre>
                </div>
            </div>
        </div>
        
        <div class="run-card ">
            <div class="run-header" onclick="toggleRun(this)">
                <div class="run-info">
                    <span class="run-badge ">#2</span>
                    <span class="run-label">Run 2</span>
                    <span class="r2-badge" style="background-color: #B22222; color: white;">
                        R² = -0.773483
                    </span>
                </div>
                <span class="expand-icon">▼</span>
            </div>
            <div class="run-content" style="display: none;">
                <div class="code-container">
                    <div class="code-header">
                        <span>Python</span>
                        <button class="copy-btn" onclick="copyCode(event, 'code-1')">Copy</button>
                    </div>
                    <pre><code class="language-python" id="code-1">import math
from typing import List, Dict

# Log-linear (power-law) scaling law fitted on the provided dataset.
# log(lm_loss) = c + a*log(lr) + b*log(bsz) + d*log(data_size) + e*log(non_embedding_param_size)
# lm_loss = exp(c) * lr^a * bsz^b * data_size^d * non_embedding_param_size^e

_COEFFS: Dict[str, Dict[str, float]] = {
    # Single observed group in the dataset. Used as default for any group name.
    &quot;all_data&quot;: {
        &quot;const&quot;: 3.080501739652768,
        &quot;log_lr&quot;: 0.008636919053849154,
        &quot;log_bsz&quot;: -0.0005162836622543873,
        &quot;log_data_size&quot;: -0.04700957690670233,
        &quot;log_nps&quot;: -0.05174150134631459,
    },
}

_DEFAULT_GROUP = &quot;all_data&quot;


def _log_pos(x: float) -&gt; float:
    # Numerically safe log for positive quantities
    return math.log(max(float(x), 1e-12))


def law(input_data: List[Dict[str, float]], group: str) -&gt; List[Dict[str, float]]:
    &quot;&quot;&quot;
    Predicts output variables based on input variables according to a discovered scaling law.

    Args:
        input_data: A list of dictionaries, where each dictionary is a single data
                    point containing input variable names as keys and their
                    corresponding values.
        group: The name of the experimental group for which to make predictions.
                The functional form of the law is the same for all groups,
                but the constant parameters/coefficients can differ per group.

    Returns:
        A list of dictionaries, corresponding to the input_data list, with each
        dictionary containing the predicted output variable(s).
    &quot;&quot;&quot;
    coeffs = _COEFFS.get(group, _COEFFS[_DEFAULT_GROUP])
    c = coeffs[&quot;const&quot;]
    a = coeffs[&quot;log_lr&quot;]
    b = coeffs[&quot;log_bsz&quot;]
    d = coeffs[&quot;log_data_size&quot;]
    e = coeffs[&quot;log_nps&quot;]

    outputs: List[Dict[str, float]] = []
    for row in input_data:
        lr = row.get(&quot;lr&quot;, 0.0)
        bsz = row.get(&quot;bsz&quot;, 0.0)
        data_size = row.get(&quot;data_size&quot;, 0.0)
        nps = row.get(&quot;non_embedding_param_size&quot;, 0.0)

        y_log = (
            c
            + a * _log_pos(lr)
            + b * _log_pos(bsz)
            + d * _log_pos(data_size)
            + e * _log_pos(nps)
        )
        y = math.exp(y_log)
        outputs.append({&quot;lm_loss&quot;: y})

    return outputs</code></pre>
                </div>
            </div>
        </div>
        
        <div class="run-card ">
            <div class="run-header" onclick="toggleRun(this)">
                <div class="run-info">
                    <span class="run-badge ">#3</span>
                    <span class="run-label">Run 3</span>
                    <span class="r2-badge" style="background-color: #B22222; color: white;">
                        R² = -1.000000
                    </span>
                </div>
                <span class="expand-icon">▼</span>
            </div>
            <div class="run-content" style="display: none;">
                <div class="code-container">
                    <div class="code-header">
                        <span>Python</span>
                        <button class="copy-btn" onclick="copyCode(event, 'code-2')">Copy</button>
                    </div>
                    <pre><code class="language-python" id="code-2">from __future__ import annotations
import math
from typing import Dict, List


def _predict_lm_loss(x: Dict[str, float], coef: Dict[str, float]) -&gt; float:
    lr = float(x.get(&quot;lr&quot;, 0.0))
    bsz = float(x.get(&quot;bsz&quot;, 0.0))
    data_size = float(x.get(&quot;data_size&quot;, 0.0))
    non_emb = float(x.get(&quot;non_embedding_param_size&quot;, 0.0))

    # Guard against non-positive inputs for log
    eps = 1e-16
    ll = math.log10(max(lr, eps))
    lb = math.log10(max(bsz, eps))
    ld = math.log10(max(data_size, eps))
    lp = math.log10(max(non_emb, eps))

    y = (
        coef[&quot;intercept&quot;]
        + coef[&quot;log_lr&quot;] * ll
        + coef[&quot;log_bsz&quot;] * lb
        + coef[&quot;log_lr2&quot;] * (ll * ll)
        + coef[&quot;log_bsz2&quot;] * (lb * lb)
        + coef[&quot;lr_bsz&quot;] * (ll * lb)
        + coef[&quot;log_data&quot;] * ld
        + coef[&quot;log_params&quot;] * lp
    )
    return float(y)


# Coefficients discovered via log-polynomial regression on the provided dataset.
# Functional form is the same for all groups; coefficients may differ per group.
COEFFS_BY_GROUP: Dict[str, Dict[str, float]] = {
    &quot;all_data&quot;: {
        &quot;intercept&quot;: 9.919174347950008,
        &quot;log_lr&quot;: 0.934534343690493,
        &quot;log_bsz&quot;: -0.6179383648150774,
        &quot;log_lr2&quot;: 0.1368417220658123,
        &quot;log_bsz2&quot;: 0.09978735298702487,
        &quot;lr_bsz&quot;: -0.060204456752825174,
        &quot;log_data&quot;: -0.28033584602209644,
        &quot;log_params&quot;: -0.30419462596816593,
    }
}

# Fallback: if an unknown group is requested, use the closest available baseline.
DEFAULT_GROUP = &quot;all_data&quot;


def law(input_data: List[Dict[str, float]], group: str) -&gt; List[Dict[str, float]]:
    &quot;&quot;&quot;
    Predicts output variables based on input variables according to a discovered scaling law.

    Args:
        input_data: A list of dictionaries, where each dictionary is a single data
                    point containing input variable names as keys and their
                    corresponding values.
        group: The name of the experimental group for which to make predictions.
                The functional form of the law is the same for all groups,
                but the coefficients can differ per group.

    Returns:
        A list of dictionaries, corresponding to the input_data list, with each
        dictionary containing the predicted output variable(s).
    &quot;&quot;&quot;
    coef = COEFFS_BY_GROUP.get(group, COEFFS_BY_GROUP[DEFAULT_GROUP])
    out = []
    for row in input_data:
        y = _predict_lm_loss(row, coef)
        out.append({&quot;lm_loss&quot;: y})
    return out</code></pre>
                </div>
            </div>
        </div>
        
        </div>
        
        <footer class="footer">
            <p>SLDBench | <a href="https://arxiv.org/abs/2507.21184" target="_blank">arXiv:2507.21184</a> | <a href="https://github.com/linhaowei1/SLD" target="_blank">GitHub</a></p>
        </footer>
    </div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script>
        function toggleRun(header) {
            const content = header.nextElementSibling;
            const isExpanded = content.style.display === 'block';
            content.style.display = isExpanded ? 'none' : 'block';
            header.classList.toggle('expanded', !isExpanded);
        }
        
        function copyCode(event, codeId) {
            event.stopPropagation();
            const code = document.getElementById(codeId).textContent;
            navigator.clipboard.writeText(code).then(() => {
                const btn = event.target;
                btn.textContent = 'Copied!';
                setTimeout(() => btn.textContent = 'Copy', 2000);
            });
        }
        
        Prism.highlightAll();
    </script>
</body>
</html>